<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="cropped_image.png" type="image/x-icon" />
    <title>Fixture</title>
    <link href="style.css" />
  </head>
  <body>
    <div id="navbar-placeholder"></div>
    <section class="section">
      <h1>Fixture & Result</h1>
      <h3 id="playoff">Playoffs</h3>
    </section>
    <div class="fixtures" id="fixtures-container"></div>

    <!-- Modal for Team History -->
    <div class="modal-overlay" id="modal-overlay"></div>
    <div class="modal" id="team-history-modal">
      <h2 id="modal-title"></h2>
      <div id="modal-content"></div>
      <span class="close-modal" id="close-modal">Close</span>
    </div>
    <!-- Modal for playoffs -->
    <div class="modal-playoff" id="modal-playoff"></div>
    <div class="modal" id="playoff-modal">
      <h2 id="modal-title-playoff"></h2>
      <div id="modal-content-playoff">
        <div class="fixture-card-playoff" id="Qualifier">
          <div>Qualifier</div>
          1st &nbsp;&nbsp; NaN &nbsp;&nbsp; VS &nbsp;&nbsp; NaN &nbsp;&nbsp; 2nd
          <span id="line-label-Q-F">Winner</span>
          <span id="line-label-Q-E2">Loser</span>
        </div>
        <div class="fixture-card-playoff" id="Eliminator1">
          <div>Eliminator 1</div>
          3rd &nbsp;&nbsp; NaN &nbsp;&nbsp; VS &nbsp;&nbsp; 4th &nbsp;&nbsp; 4th
          <span id="line-label-E1-E2">Winner</span>
        </div>
        <div class="fixture-card-playoff" id="Eliminator2">
          <div>Eliminator 2</div>
          L of Q &nbsp;&nbsp; NaN &nbsp;&nbsp; VS &nbsp;&nbsp; NaN &nbsp;&nbsp;W
          of E2
          <span id="line-label-E2-F">Winner</span>
        </div>

        <div class="fixture-card-playoff" id="Final">
          <div>Final</div>
          W of Q &nbsp;&nbsp; NaN &nbsp;&nbsp; VS &nbsp;&nbsp; NaN &nbsp;&nbsp;W
          of E1
        </div>
        <div class="fixture-card-final-winner" id="FinalWinner">
          <div class="winner-text">
            <span class="winner-label">Champion</span>
            <span class="winner-name">W</span>
          </div>
        </div>
      </div>

      <span class="close-modal" id="close-modal-playoff">Close</span>
    </div>

    <script>
      // Fetch and insert navbar
      fetch("base.html")
        .then((response) => response.text())
        .then(
          (data) =>
            (document.getElementById("navbar-placeholder").innerHTML = data)
        );

      // const playoffData = [
      //   //Qualifier
      //   {
      //     teamA: "Pujann",
      //     scoreA: NaN,
      //     date: "2025-1-30",
      //     time: "12:00 PM",
      //     scoreB: NaN,
      //     teamB: "Pujan",
      //   },
      //   //Eliminator 1
      //   {
      //     teamA: "NaN",
      //     scoreA: NaN,
      //     date: "2025-1-30",
      //     time: "12:00 PM",
      //     scoreB: NaN,
      //     teamB: "NaN",
      //   },
      //   //Eliminator 2
      //   {
      //     teamA: "NaN",
      //     scoreA: NaN,
      //     date: "2025-1-30",
      //     time: "12:00 PM",
      //     scoreB: NaN,
      //     teamB: "NaN",
      //   },
      //   //Final
      //   {
      //     teamA: "NaN",
      //     scoreA: NaN,
      //     date: "2025-1-30",
      //     time: "12:00 PM",
      //     scoreB: NaN,
      //     teamB: "NaN",
      //   },
      // ];
      const fixtureData = [
        //Round 1
        {
          teamA: "Prabesh",
          scoreA: NaN,
          date: "2025-1-20",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Ronish",
        },
        {
          teamA: "Roman",
          scoreA: NaN,
          date: "2025-1-20",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Pujan",
        },
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-20",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Aadhar",
        },
        {
          teamA: "Sujan",
          scoreA: NaN,
          date: "2025-1-20",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Sudip",
        },
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-20",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Bijay",
        },
        //Round 2
        {
          teamA: "Pujan",
          scoreA: NaN,
          date: "2025-1-21",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Prabesh",
        },
        {
          teamA: "Aadhar",
          scoreA: NaN,
          date: "2025-1-21",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Ronish",
        },
        {
          teamA: "Sudip",
          scoreA: NaN,
          date: "2025-1-21",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Roman",
        },
        {
          teamA: "Bijay",
          scoreA: NaN,
          date: "2025-1-21",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Dip",
        },
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-21",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Sujan",
        },
        //Round 3
        {
          teamA: "Prabesh",
          scoreA: NaN,
          date: "2025-1-22",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Aadhar",
        },
        {
          teamA: "Pujan",
          scoreA: NaN,
          date: "2025-1-22",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Sudip",
        },
        {
          teamA: "Ronish",
          scoreA: NaN,
          date: "2025-1-22",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Bijay",
        },
        {
          teamA: "Roman",
          scoreA: NaN,
          date: "2025-1-22",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Samrat",
        },
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-22",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Sujan",
        },
        //Round 4
        {
          teamA: "Bijay",
          scoreA: NaN,
          date: "2025-1-23",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Aadhar",
        },
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-23",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Pujan",
        },
        {
          teamA: "Sudip",
          scoreA: NaN,
          date: "2025-1-23",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Prabesh",
        },
        {
          teamA: "Sujan",
          scoreA: NaN,
          date: "2025-1-23",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Ronish",
        },
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-23",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Roman",
        },
        //Round 5
        {
          teamA: "Sudip",
          scoreA: NaN,
          date: "2025-1-24",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Samrat",
        },
        {
          teamA: "Prabesh",
          scoreA: NaN,
          date: "2025-1-24",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Bijay",
        },
        {
          teamA: "Aadhar",
          scoreA: NaN,
          date: "2025-1-24",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Sujan",
        },
        {
          teamA: "Pujan",
          scoreA: NaN,
          date: "2025-1-24",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Dip",
        },
        {
          teamA: "Ronish",
          scoreA: NaN,
          date: "2025-1-24",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Roman",
        },
        //Round 6
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-25",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Prabesh",
        },
        {
          teamA: "Sujan",
          scoreA: NaN,
          date: "2025-1-25",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Bijay",
        },
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-25",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Sudip",
        },
        {
          teamA: "Roman",
          scoreA: NaN,
          date: "2025-1-25",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Aadhar",
        },
        {
          teamA: "Ronish",
          scoreA: NaN,
          date: "2025-1-25",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Pujan",
        },
        //Round 7
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-26",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Dip",
        },
        {
          teamA: "Prabesh",
          scoreA: NaN,
          date: "2025-1-26",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Sujan",
        },
        {
          teamA: "Bijay",
          scoreA: NaN,
          date: "2025-1-26",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Roman",
        },
        {
          teamA: "Sudip",
          scoreA: NaN,
          date: "2025-1-26",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Ronish",
        },
        {
          teamA: "Aadhar",
          scoreA: NaN,
          date: "2025-1-26",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Pujan",
        },
        //Round 8
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-27",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Prabesh",
        },
        {
          teamA: "Roman",
          scoreA: NaN,
          date: "2025-1-27",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Sujan",
        },
        {
          teamA: "Ronish",
          scoreA: NaN,
          date: "2025-1-27",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Samrat",
        },
        {
          teamA: "Pujan",
          scoreA: NaN,
          date: "2025-1-27",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Bijay",
        },
        {
          teamA: "Aadhar",
          scoreA: NaN,
          date: "2025-1-27",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Sudip",
        },
        //Round 9
        {
          teamA: "Sujan",
          scoreA: NaN,
          date: "2025-1-28",
          time: "12:00 PM",
          scoreB: NaN,
          teamB: "Pujan",
        },
        {
          teamA: "Dip",
          scoreA: NaN,
          date: "2025-1-28",
          time: "02:00 PM",
          scoreB: NaN,
          teamB: "Ronish",
        },
        {
          teamA: "Prabesh",
          scoreA: NaN,
          date: "2025-1-28",
          time: "04:00 PM",
          scoreB: NaN,
          teamB: "Roman",
        },
        {
          teamA: "Samrat",
          scoreA: NaN,
          date: "2025-1-28",
          time: "06:00 PM",
          scoreB: NaN,
          teamB: "Aadhar",
        },
        {
          teamA: "Bijay",
          scoreA: NaN,
          date: "2025-1-28",
          time: "08:00 PM",
          scoreB: NaN,
          teamB: "Sudip",
        },
      ];

      function renderFixtures(data) {
        const container = document.getElementById("fixtures-container");
        container.innerHTML = ""; // Clear existing content

        // Group fixtures by date
        const fixturesByDate = data.reduce((acc, fixture) => {
          if (!acc[fixture.date]) {
            acc[fixture.date] = [];
          }
          acc[fixture.date].push(fixture);
          return acc;
        }, {});

        let roundNumber = 1; // Initialize round number

        // Render grouped fixtures
        Object.keys(fixturesByDate).forEach((date) => {
          const card = document.createElement("div");
          card.className = "fixture-card";

          card.innerHTML = `
      <div class="fixture-header">
        <span>Round ${roundNumber}</span>
        <span>${date}</span>
      </div>
      <div class="fixture-details">
        <table class="fixture-table">
          <thead>
            
          </thead>
          <tbody>
            ${fixturesByDate[date]
              .map(
                (fixture) => `
                <tr>
                  <td class="team" style="text-align:left;" data-team="${
                    fixture.teamA
                  }">${fixture.teamA}</td>
                  <td class="score" style="text-align:center;">${
                    isNaN(fixture.scoreA) ? "-" : fixture.scoreA
                  }</td>
                  <td class="vs" style="text-align:center;">vs</td>
                  <td class="score" style="text-align:center;">${
                    isNaN(fixture.scoreB) ? "-" : fixture.scoreB
                  }</td>
                  <td class="team" style="text-align:right;" data-team="${
                    fixture.teamB
                  }">${fixture.teamB}</td>
                  <td class="time" style="text-align:right;">${
                    fixture.time
                  }</td>
                </tr>`
              )
              .join("")}
          </tbody>
        </table>
      </div>
    `;

          container.appendChild(card);
          roundNumber++; // Increment round number for each date
        });

        // Add click listeners to team names
        document.querySelectorAll(".team").forEach((teamElement) => {
          teamElement.addEventListener("click", (event) => {
            const teamName = event.target.getAttribute("data-team");
            showTeamHistory(teamName);
          });
        });
      }

      // Function to show team history in a modal
      function showTeamHistory(team) {
        const modal = document.getElementById("team-history-modal");
        const overlay = document.getElementById("modal-overlay");
        const modalTitle = document.getElementById("modal-title");
        const modalContent = document.getElementById("modal-content");

        // Filter fixtures for the selected team
        const teamFixtures = fixtureData.filter(
          (fixture) => fixture.teamA === team || fixture.teamB === team
        );

        // Set modal content
        modalTitle.textContent = `${team}'s Record`;
        modalContent.innerHTML = teamFixtures
          .map((fixture) => {
            const isVictory =
              (fixture.teamA === team && fixture.scoreA > fixture.scoreB) ||
              (fixture.teamB === team && fixture.scoreB > fixture.scoreA);
            const isDraw = fixture.scoreA === fixture.scoreB; // Check for draw
            const resultClass = isVictory ? "win" : isDraw ? "draw" : "loss";
            const resultText = isVictory ? "Win" : isDraw ? "Draw" : "Loss";

            // Check for NaN scores
            const isNaNScore = isNaN(fixture.scoreA) || isNaN(fixture.scoreB);
            const resultClassWithNaN = isNaNScore ? "NP" : resultClass;
            const resultTextWithNaN = isNaNScore ? "No Result" : resultText;

            return `
        <div class="history-card ${resultClassWithNaN}" }">
          <span>${fixture.date}&nbsp;&nbsp; ${fixture.time}</span>
          <div>
            ${fixture.teamA}&nbsp; ${
              isNaNScore ? "N/A" : fixture.scoreA
            }&nbsp; vs &nbsp;${isNaNScore ? "N/A" : fixture.scoreB} &nbsp;${
              fixture.teamB
            } 
            <strong> - ${resultTextWithNaN}</strong>
          </div>
        </div>
      `;
          })
          .join("");

        // Open modal
        modal.classList.add("open");
        overlay.classList.add("open");
      }

      // Close modal
      document.getElementById("close-modal").addEventListener("click", () => {
        document.getElementById("team-history-modal").classList.remove("open");
        document.getElementById("modal-overlay").classList.remove("open");
      });

      // Function to render Playoff modal content
      function showPlayoffModal() {
        const modal = document.getElementById("playoff-modal");
        const overlay = document.getElementById("modal-overlay");
        const modalTitle = document.getElementById("modal-title-playoff");
        const modalContent = document.getElementById("modal-content-playoff");

        // Set title
        modalTitle.textContent = "Playoff Schedule";

        // Generate content for the playoff modal
        // modalContent.innerHTML = playoffData
        //   .map(
        //     (playoff, index) => `
        //     <div class="playoff-card">
        //       <span>Match ${index + 1}: ${playoff.teamA} vs ${playoff.teamB}</span>
        //       <div>
        //         <span>Date: ${playoff.date}</span>
        //         <span>Time: ${playoff.time}</span>
        //         <span>Score: ${isNaN(playoff.scoreA) ? "-" : playoff.scoreA} - ${
        //       isNaN(playoff.scoreB) ? "-" : playoff.scoreB
        //     }</span>
        //       </div>
        //     </div>
        //   `
        //   )
        //   .join("");

        // Open modal
        modal.classList.add("open");
        overlay.classList.add("open");
      }

      // Close Playoff Modal
      document
        .getElementById("close-modal-playoff")
        .addEventListener("click", () => {
          document.getElementById("playoff-modal").classList.remove("open");
          document.getElementById("modal-overlay").classList.remove("open");
        });

      // Add event listener to the Playoff heading
      document
        .getElementById("playoff")
        .addEventListener("click", showPlayoffModal);

      // Render fixtures
      renderFixtures(fixtureData);
    </script>
  </body>
</html>
